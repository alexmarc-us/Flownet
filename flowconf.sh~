#!/bin/bash
#
# Alex Marcus
# Flowconf : Flownet Server Configuration Wizard
# Connecticut College Computer Science 495
# Fall 2009
# amarcus@conncoll.edu

# Run as: ./flowconf.sh

echo "Welcome to the Flownet configuration wizard!"

echo
# Check if flownet user exists
grep "flownet" /etc/passwd 2> /dev/null
if [ $? ! -eq 0 ]
then
    # flownet user exists
else
    # flownet user needs to be created

# Get Flownet password of remote server from user
read -s -p "Enter password for flownet@${$1}: " REMOTEPASS

#### SSH No-Password RSA Key Setup
# Check if /home/flownet/.ssh/id.rsa.pub contains username@localhostname
find /home/flownet/.ssh/ -type f | xargs grep "`whoami`@`hostname`"
if [ $? -eq 0 ]
then
    # Don't do anything, RSA key has already been generated
else
    # RSA key needs generating
    ssh-keygen
fi
